<div class="admin-dashboard-container">
  <header class="admin-header">
    <div class="header-left">
      <button class="back-btn" (click)="goBack()">â† Back</button>
      <h1>Advanced Settings</h1>
      <span class="current-time">{{ currentTime }}</span>
    </div>
    <div class="header-right">
      <button class="logout-btn" (click)="logout()">Disconnect</button>
      <button class="refresh-btn" (click)="refreshData()" [disabled]="loading">
        <span class="refresh-icon" [class.spinning]="loading">ğŸ”„</span>
        {{ loading ? 'Refreshing...' : 'Refresh' }}
      </button>
    </div>
  </header>

  <div *ngIf="error" class="error-banner">
    <div class="error-content">
      <span class="error-icon">âš ï¸</span>
      <span class="error-message">{{ error }}</span>
      <button class="error-close" (click)="clearError()">Ã—</button>
    </div>
  </div>

  <div class="dashboard-content">
    
    <div *ngIf="loading" class="loading-overlay">
      <div class="loading-spinner">
        <div class="spinner"></div>
        <p>Loading dashboard data...</p>
      </div>
    </div>
    
    <div class="stats-grid">
      <div class="stat-card users-card" >
        <div class="stat-icon">ğŸ‘¥</div>
        <div class="stat-content">
          <div class="stat-value">{{ dashboardData.stats.totalUsers }}</div>
          <div class="stat-label">Total Users</div>
          <div class="stat-subtitle">
            {{ dashboardData.stats.activeUsers }} active, 
            {{ dashboardData.stats.inactiveUsers }} inactive
          </div>
        </div>
      </div>
      </div>

    <div class="bottom-grid">
      <div class="recent-users-section">
        <h2>Empleados</h2>
        
        <div *ngIf="loading && dashboardData.allUsers.length === 0" class="users-loading">
          <div class="loading-text">Loading user attendance...</div>
        </div>
        
        <div *ngIf="!loading && dashboardData.allUsers.length === 0" class="empty-users">
          <div class="empty-icon">ğŸ‘¥</div>
          <div class="empty-text">No Users Found</div>
          <div class="empty-subtitle">User data could not be loaded or none exist.</div>
        </div>
        
        <div class="users-list" *ngIf="dashboardData.allUsers.length > 0">
          <div class="user-item" *ngFor="let user of dashboardData.allUsers">
            <div class="user-avatar">{{ getUserAvatar(user) }}</div>
            <div class="user-info">
              <div class="user-name">{{ user.firstName || user.name }} {{ user.lastName || '' }}</div>
              <div class="user-email">{{ user.email }}</div>
              
              <div class="user-attendance-details">
                <ng-container *ngIf="user.attendance_today.status !== 'Absent'; else noActivity">
                  <span class="attendance-item">
                    <strong>IN:</strong> {{ user.attendance_today.hora_entrada || 'N/A' }}
                  </span>
                  <span class="attendance-item">
                    <strong>OUT:</strong> {{ user.attendance_today.hora_salida || 'Pending' }}
                  </span>
                  <span class="attendance-item duration">
                    <strong>D:</strong> {{ user.attendance_today.duracion_jornada || 'N/A' }}
                  </span>
                </ng-container>
                <ng-template #noActivity>
                  <span class="attendance-item absent">No activity recorded today</span>
                </ng-template>
              </div>
            </div>
            
            <div class="user-status" [class.active]="user.isActive" [ngClass]="{
              'present': user.attendance_today.status === 'Present',
              'completed': user.attendance_today.status === 'Completed',
              'absent': user.attendance_today.status === 'Absent'
            }">
              {{ user.isActive ? user.attendance_today.status : 'Inactive' }}
            </div>
          </div>
        </div>
        
        </div>
    </div>

    <div class="bottom-grid" *ngIf="dashboardData.stats.totalSpeakers > 0" style="margin-top: 30px;">
        </div>

    <div class="update-info" *ngIf="!loading">
      <span class="update-text">
        Last updated: {{ dashboardData.stats.lastUpdate | date:'MMM d, y, h:mm:ss a' }}
      </span>
    </div>

    <div class="bottom-buttons">
      <button class="back-btn" (click)="goBack()">â† Back</button>
    </div>
  </div>
</div>